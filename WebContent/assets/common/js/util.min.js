
var sdfun={};sdfun.fn={htmlEncode:function(value){if(value===undefined||value===null){return'';}
var temp=document.createElement('div');(temp.textContent!=null)?(temp.textContent=value):(temp.innerText=value);var output=temp.innerHTML;temp=null;return output;},htmlDecode:function(value){if(value===undefined||value===null){return'';}
if(typeof(value)=="string"){value=value.replace('&nbsp;',' ');}
var temp=document.createElement('div');temp.innerHTML=value;var output=null;if(temp.innerText!=null){if(typeof(value)=="string"){value=value.replace(/[\r\n]/g,"<br/>");}
temp.innerHTML=value;output=temp.innerText;}
else{output=temp.textContent;}
temp=null;return output;},trimAll:function(srcId){var $src=$(('#'+srcId.replace(/,/g,',#')));$src.find(':input').blur(function(){$(this).val($.trim($(this).val()));});},dialog:{show:function(){$('#dialogDiv').show().click().focus();},hide:function(){$('#dialogDiv').hide();}}};sdfun.constant={reg:{email:/^(([A-Za-z0-9]+([_\.-]*[A-Za-z0-9]+)?)@([A-Za-z0-9\.-]+)\.([a-z]{2,3})){0,128}$/,planInterval:/^\d{1,4}$/,ip:/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])(\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])){3}$/,path:/^[a-zA-Z]:[\\/]((?! )(?![^\\/]*\s+[\\/])[\w -]+[\\/])*(?! )(?![^.]+\s+\.)$/,ftpPath:/^(\/(\w+\/?)+)$/,account:/^([0-9a-zA-Z_])+$/,phone:/^[\+\d-]+$/,tel:/^([0-9-])+$/,fox:/^([0-9-]){0,16}$/,integer:/^([\d]*)$/}};function getGridHeight(delHeight){delHeight=(delHeight==null?0:delHeight);var gridHeight=0;var topFrameHeight=$(top.window.document.getElementById("mainContentFram")).height();gridHeight=(topFrameHeight);if(document.getElementById("navigationTr")){gridHeight=gridHeight-$("#navigationTr").height();}
var search=document.getElementById("searchTr");if(search&&search.style.display!="none"){gridHeight=gridHeight-$(search).height();}else{search=document.getElementById("search");if(search&&search.style.display!="none"){gridHeight=gridHeight-$(search).height()-8;}else{gridHeight=gridHeight+10;}}
var menuTabs=document.getElementById("menuTabs");if(menuTabs&&menuTabs.style.display!="none"){gridHeight=gridHeight-$("#menuTabs").height();}
if(document.getElementById("btnTr")){gridHeight=gridHeight-$("#btnTr").height();}
gridHeight=gridHeight-80-22-(delHeight);return gridHeight;}
function getGridWidth(ieWidthPer){ieWidthPer=ieWidthPer==null?0.977:ieWidthPer;var gridWidth=parseInt($(window).width()*ieWidthPer);var left=document.getElementById("leftContent");if(left&&left.style.display!="none"){gridWidth=gridWidth-$(left).width();}
var centerContent=document.getElementById("centerContent");if(centerContent&&centerContent.style.display!="none"){gridWidth=gridWidth-$(centerContent).width();}
return gridWidth;}
function getLeftTreeHeight(){var gridHeight=($(top.window).height()-88);if(gridHeight<493){gridHeight=493;}
return gridHeight;}
function toJsonData(data)
{var jsonData=null;if(typeof(data)=="string"){try
{jsonData=eval('('+data+')');}catch(e)
{}}
return jsonData;}
function checkLength(o,min,max){var _temp=o;if(o[0].tagName==='SELECT'){_temp=o.next().find('input');}
if($.trim(o.val()).length>(max||9999)||$.trim(o.val()).length<min){_temp.addClass("ui-state-error").focus();return false;}else{_temp.removeClass("ui-state-error");return true;}}
function checkDecimals(objField)
{var patrn=/^([\d]+)([.]?)([\d]*)$/;if(patrn.test(objField.val()))
{objField.removeClass("ui-state-error");return true;}
else
{objField.addClass("ui-state-error").focus();return false;}}
function checkEmpty(o,emptyValue){var _temp=o;if(o[0].tagName==='SELECT'){_temp=o.next().find('input');}
if((emptyValue!=null&&$.trim(o.val())==emptyValue)||$.trim(o.val()).length<1){_temp.addClass("ui-state-error").focus();return false;}else{_temp.removeClass("ui-state-error");return true;}}
function checkLimit(o,min,max){var v=$.trim(o.val()),flag=true;if(!v||isNaN(v)){flag=false;}else{v=parseInt(v);flag=!(v>max||v<min)}
if(!flag){o.addClass("ui-state-error").focus();}else{o.removeClass("ui-state-error");}
return flag;}
function getDocVal(id,val){return $("#"+id+" option[value="+val+"]").html();}
function checkRegexp(o,regexp,n){if(!(regexp.test(o.val()))){o.addClass("ui-state-error");if(n&&n!="")
{o.attr("title",n);}
o.focus();return false;}else{o.removeClass("ui-state-error");return true;}}
function checkPort(o,n)
{if(checkLength(o,1,5)&&checkRegexp(o,/^\d+$/,n)&&o.val()<65536&&o.val()>0)
{o.removeClass("ui-state-error");return true;}
else
{o.addClass("ui-state-error");if(n&&n!="")
{o.attr("title",n);}
o.focus();return false;}}
function checkExists(url,o,checkParam,errorMessage)
{var exists=false;$.ajax({type:'POST',url:url,dataType:'json',async:false,cache:false,data:checkParam,success:function(data){if(data.msg){message({data:data});exists="error";}
else{if(data)
{message({html:errorMessage,showConfirm:true,confirm:function(){o.addClass("ui-state-error");o.focus();}});exists=true;}}}});return exists;}
function getFlexiGridRowText(grid,cellNumber){var arr=new Array(0);$("tr td:nth-child("+cellNumber+") div",$(grid)).each(function(i){arr.push($(this).text());});return arr;}
function getFlexiGridCurrentRowText(thisObj,grid,cellNumber){var arr=new Array(0);$(thisObj).parent().parent().siblings(":nth-child("+cellNumber+")").find("div",$(grid)).each(function(i){arr.push($(this).text());});return arr;}
function getFlexiGridSelectedRowText(grid,cellNumber){var arr=new Array(0);$(".trSelected td:nth-child("+cellNumber+") div",$(grid)).each(function(i){var $parent=$(this).parent().parent(),$chk=$parent.find(":checkbox").size(),$radio=$parent.find(":radio").size();if(($chk==1)||($radio==1)){arr.push($(this).text());}});return arr;}
function flexiGridCheckBack(grid,cellNumber,list){for(var i=0;i<list.length;i++){var ptr=$(grid).find("td:nth-child("+cellNumber+") div:contains('"+list[i]+"')").map(function(){if($(this).text()==list[i]){return this;}}).parent().parent();$(ptr).find("input.itemchk").attr("checked",true);$(ptr).addClass("trSelected");}}
function getFlexiGridClickRowText(obj,column){var columnsArray=$(obj).parent().parent().parent().attr("ch").split("_FG$SP_");if(typeof(column)=="undefined"){return columnsArray;}else{return columnsArray[column];}}
function action(name,obj)
{var css=$(this).find("span").attr("class");$(this).find("span").removeAttr("class");if(css=='exper')
{$(this).find("span").addClass("exper2");}
else
{$(this).find("span").addClass("exper");}
$(obj).find(".bDiv").toggle();$(obj).find(".hDiv").toggle();}
var sysNowDate=new Date();var sysNowYear=sysNowDate.getFullYear();var sysNowMonth=sysNowDate.getMonth()+1;var sysNowDay=sysNowDate.getDate();function generateYear(selectId){var destObj=document.getElementById(selectId);destObj.options.add(new Option(sysNowYear,sysNowYear));for(var i=1;i<3;i++){var year=sysNowYear-i;destObj.options.add(new Option(year,year));}}
function changeYear(selectYearId,selectMonthId,selectDayId){var year=$('#'+selectYearId).val();var month=$('#'+selectMonthId)[0];month.options.length=1;var months=year===sysNowYear+""?sysNowMonth+"":12;for(var i=1;i<=months;i++){month.options.add(new Option(i,i<10?('0'+i):i));}
$('#'+selectMonthId).combobox('destroy').combobox();changeMonth(selectYearId,selectMonthId,selectDayId);}
function changeMonth(selectYearId,selectMonthId,selectDayId){var year=$('#'+selectYearId).val();var month=$('#'+selectMonthId).val();var day=$('#'+selectDayId)[0];day.options.length=1;if(month){var days=0;var sysMonth=sysNowMonth<10?('0'+sysNowMonth):sysNowMonth+"";if((year===sysNowYear+"")&&(month===sysMonth)){days=sysNowDay+"";}else if(month==1||month==3||month==5||month==7||month==10||month==12){days=31}else if(month==2){var year=$('#'+selectYearId).val()-0;if(year%400===0||year%4===0&&year%100!==0){days=29;}else{days=28;}}else{days=30;}
for(var i=1;i<=days;i++){day.options.add(new Option(i,i<10?('0'+i):i));}}
$('#'+selectDayId).combobox('destroy').combobox();}
function getCurrentDate(pattern,sysDate){if(sysDate==null){sysDate=new Date();}
var year=sysDate.getFullYear();var month=sysDate.getMonth()+1;if(month<10){month="0"+month;}
var day=sysDate.getDate();if(day<10){day="0"+day;}
var hours=sysDate.getHours();if(hours<10){hours="0"+hours;}
var minutes=sysDate.getMinutes();if(minutes<10){minutes="0"+minutes;}
var seconds=sysDate.getSeconds();if(seconds<10){seconds="0"+seconds;}
var currentDate='';if(pattern=='yyyy'){currentDate=year;}else if(pattern=='MM'){currentDate=month;}else if(pattern=='dd'){currentDate=day;}else if(pattern=='yyyy-MM'){currentDate=year+"-"+month;}else if(pattern=='yyyy-MM-dd'){currentDate=year+"-"+month+"-"+day;}else if(pattern=='yyyy-MM-dd HH'){currentDate=year+"-"+month+"-"+day+" "+hours;}else if(pattern=='yyyy-MM-dd HH:mm'){currentDate=year+"-"+month+"-"+day+" "+hours+":"+minutes;}else if(pattern=='HH:mm'){currentDate=hours+":"+minutes;}else{currentDate=year+"-"+month+"-"+day+" "+hours+":"+minutes+":"+seconds;}
return currentDate;}
function placeHolderProcess(msg,args){if(msg!=null&&args!=null){if($.isArray(args)){$.each(args,function(i,o){msg=msg.replace('{'+i+'}',o);});}else if($.type(args)==="string"){msg=msg.replace(/\{\d?\}/,args);}}
return msg;}
function loadPage(p){p=$.extend({id:'',url:'',width:400,height:400,title:'',data:[],buttons:{},openCallBack:null,closeCallBack:null,createDialog:false,removeOnClose:true},p);if(p.createDialog){var $div=$("<div>");if(p.title){$div.attr("title",p.title);}
if(p.id){$div.attr("id",p.id);}
$div.load(p.url,p.data,function(response,status,xhr){var responseJson=toJsonData(response);if(responseJson!=null&&responseJson.success==false){message({data:responseJson});}});$div.dialog({autoOpen:true,width:p.width,height:p.height,modal:true,resizable:false,buttons:p.buttons,open:function(){var openFun=p.openCallBack;if($.isFunction(openFun)){openFun();}},close:function(){var closeCallBack=p.closeCallBack;if(typeof closeCallBack==='function'){closeCallBack();}
if(p.removeOnClose){$div.parent().empty().remove();$div.empty().remove();}}});}else{$.ajax({type:'POST',url:p.url,dataType:'html',cache:false,data:p.data,success:function(data){var responseJson=toJsonData(data);if(responseJson!=null&&responseJson.success==false){message({data:responseJson});}else{$(data).appendTo("body");var openFun=p.openCallBack;if($.isFunction(openFun)){openFun();}
if(p.id){var close=$("#"+p.id).dialog("option","close");var closeCallBack=p.closeCallBack;$("#"+p.id).dialog("option","close",function(){if($.isFunction(close)){close();}
if($.isFunction(closeCallBack)){closeCallBack();}
if(p.removeOnClose){$(this).parent().empty().remove();$(this).empty().remove();}});}}}});}}
function showCommonTree(p){p=$.extend({treeType:"1",url:"",width:330,height:450,title:"",confirmCallBack:"",closeCallBack:"",treeSetting:null,maxLevel:null},p);var param=$.extend(true,{},p);if(param&&param.treeSetting&&param.treeSetting.callback){$.each(param.treeSetting.callback,function(k,v){if($.isFunction(v)){param.treeSetting.callback[k]=getFunName(v);}});}
delete param.url;$.ajax({type:"POST",url:p.url,dataType:'html',cache:false,data:{param:JSON.stringify(param),maxLevel:p.maxLevel},success:function(data){var responseJson=toJsonData(data);if(responseJson!=null&&responseJson.success==false){message({data:responseJson});}else{$(data).appendTo("body");var $dialogDiv=$("#arch_tree_common_dialog");if(p.treeType==2){$dialogDiv=$("#depart_tree_common_dialog");}
var closeCallBack=p.closeCallBack;var close=$dialogDiv.dialog("option","close");$dialogDiv.dialog("option","close",function(){if($.isFunction(close)){close();}
$(this).parent().empty().remove();$(this).empty().remove();});}}});}
function getFunName(f){var str=f.toString();var names=str.match(/^function\s([\w]+)\(([\w,\s]*)\)/g);if(names!=null){var name=names[0];name=name.replace(/function\s/,"");var i=name.indexOf("(");return name.substring(0,i);}else{return str;}}
function parseStringToDate(str){if($.type(str)==='date'){return str;}
var _parsedStr=[];if(str.indexOf("-")!=-1){var times=str.split(" ");var _ymd=times[0].split("-");$.each(_ymd,function(_j,_t){var _t=parseInt(_t);if(_j==1&&_t>0){_t=_t-1;}
_parsedStr.push(_t);});if(times.length>1){var hhmmss=times[1].split(":");$.each(hhmmss,function(_idx,val){_parsedStr.push(parseInt(val));});}}else{}
var _time=[0,0,0,0,0,0];$.each(_parsedStr,function(_idx,_val){_time[_idx]=_val;});return new Date(_time[0],_time[1],_time[2],_time[3],_time[4],_time[5]);}
function resetForm(formId){var $form=$('#'+formId);$form.find('input').val('').removeClass("ui-state-error");;$form.find('select').val('');$form.find('select').combobox('destroy').combobox();return $form;}
function validateInput(id)
{var ret=true;var _$this=null;var _$tags=$("#"+id+" :input:not(select):visible").add("#"+id+" select");if(_$tags.length==0){_$tags=$("#"+id);}
_$tags.each(function(){_$this=$(this);var _selectShowed=false;if(_$this.is("select")){_selectShowed=_$this.next().find('input').is(":visible");}
if((_$this.is(":visible")||_selectShowed)&&typeof(this.value)!="undefined")
{_$this.val($.trim(_$this.val()));if(ret&&_$this.attr("empty")=='false')
{if(!checkEmpty(_$this)){ret=false;}}
if(ret&&_$this.attr("maxlength"))
{var _min=_$this.attr("minlength")?_$this.attr("minlength"):0;var _max=_$this.attr("maxlength");if(!checkLength(_$this,_min,_max)){ret=false;}}
if(ret&&_$this.attr("regex")&&_$this.val()!="")
{var regexp=_$this.attr("regex");if("number"==regexp)
{!checkDecimals(_$this)&&(ret=false);if(ret){var range=_$this.attr("range");if(range){var rangeArr=range.split(","),integerLen=0,decimalLen=0;if(rangeArr.length==1){integerLen=rangeArr[0];}else if(rangeArr.length==2){integerLen=rangeArr[0];decimalLen=rangeArr[1];}
var pattern="/^([\\d]{1,"+integerLen;if(decimalLen==0){pattern+="})$/";}else{pattern+="})([.]{1})([\\d]{1,"+decimalLen+"})$/";}
if(!checkRegexp(_$this,eval(pattern))){ret=false};}}}
else if("integer"==regexp)
{if(!checkRegexp(_$this,sdfun.constant.reg.integer))
ret=false;}
else if("account"==regexp)
{if(!checkRegexp(_$this,sdfun.constant.reg.account))
ret=false;}
else if("mail"==regexp)
{if(!checkRegexp(_$this,sdfun.constant.reg.mail))
ret=false;}
else if("phone"==regexp)
{if(!checkRegexp(_$this,sdfun.constant.reg.phone))
ret=false;}
else if("port"==regexp)
{if(!checkPort(_$this))
ret=false;}
else
{if(sdfun.constant.reg[regexp]!=null){!checkRegexp(_$this,sdfun.constant.reg[regexp])&&(ret=false);}else{!checkRegexp(_$this,eval(regexp))&&(ret=false);}}}
if(!ret){return ret;}}});if(ret){_$this=null;}
return _$this;}
function emptySelect(obj){obj.next("span").remove();obj.empty();}